# Initial set of jobs that will be extended over time as
# we get things working.
- project:
    templates:
      - integrated-gate-py35
      - publish-openstack-docs-pti
      - openstack-cover-jobs
      - openstack-lower-constraints-jobs
      - openstack-python-jobs
      - openstack-python35-jobs
      - openstack-python36-jobs
    check:
      jobs:
        - openstack-tox-functional
        - openstack-tox-functional-py35
        - openstack-tox-functional-py36
        - placement-perfload:
            voting: false
    gate:
      jobs:
        - openstack-tox-functional
        - openstack-tox-functional-py35
        - openstack-tox-functional-py36

# TODO(cdent): Using devstack (even minimal) here is more than we need. We
# ought to be able to take a blank node, install placement on it, use
# environment variables for configuration, run placeload, and collect the logs.
# However, that requires more knowledge of zuul and ansible than I currently
# have and we can iterate.
- job:
    name: placement-perfload
    parent: devstack-minimal
    description: |
        Run a tiny devstack with just placement and keystone and log placement
        performance.
    required-projects:
        - git.openstack.org/openstack/keystone
        - git.openstack.org/openstack/placement
    run: playbooks/perfload.yaml
    vars:
      devstack_services:
        mysql: true
        placement-api: true
        key: true
